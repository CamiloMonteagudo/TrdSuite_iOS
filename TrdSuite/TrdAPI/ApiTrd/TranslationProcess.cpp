// TranslationProcess.cpp: implementation of the CTrdProc class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "TranslationProcess.h"
#include "Translation.h"
#include "TranslateSentence.h"
#include "PeekMsg.h"


//////////////////////////////////////////////////////////////////////
// Libera el puntero al objeto oraci贸n
//////////////////////////////////////////////////////////////////////

void CTranslationUser::FreePtrSentence()
	{
	if(GetPtrSentence() != NULL)
		{
		delete GetPtrSentence();
		SetPtrSentence(NULL);
		}
	}


//////////////////////////////////////////////////////////////////////
// Realiza la traducci贸n de toda la oraci贸n
//////////////////////////////////////////////////////////////////////

void CTranslationUser::TranslateSentence()
	{
	///////////////////////////////////////////////////
	// Traduce la oraci贸n
	///////////////////////////////////////////////////

	CTranslateSentence objTranslateSentence(this,GetPtrSentence());

	objTranslateSentence.Process();

	///////////////////////////////////////////////////
	// lista de palabras no encontradas en el documento
	///////////////////////////////////////////////////
	if(m_strDocNotFoundWordList.IsEmpty() == FALSE)
		{
		m_strDocNotFoundWordList += ";";
		}
	m_strDocNotFoundWordList += GetNotFoundWordList();

	///////////////////////////////////////////////////
	// Addiciona palabras a la lista de palabras traducidas del documento
	///////////////////////////////////////////////////
	if(m_strDocWordList.IsEmpty() == FALSE)
		{
		m_strDocWordList += ";";
		}
	m_strDocWordList += GetWordList();

	///////////////////////////////////////////////////
	// Frase idiomaticas encontradas en el documento
	///////////////////////////////////////////////////
	if(m_strDocFoundPhraseList.IsEmpty() == FALSE)
		{
		m_strDocFoundPhraseList += ";";
		}
	m_strDocFoundPhraseList += GetFoundPhraseList();

	///////////////////////////////////////////////////
	// Cantidad de bytes del documento
	///////////////////////////////////////////////////
	m_DocByteCount += GetByteCount();

	}

//////////////////////////////////////////////////////////////////////
